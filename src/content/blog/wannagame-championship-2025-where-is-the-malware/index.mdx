---
title: 'WannaGame Championship 2025 - Where is the Malware?'
description: 'Forensic analysis of a ransomware attack involving a fake EVKey installer that deployed browser-based encryption. Recovering the AES-256-GCM key from Chrome cache to decrypt victim files and extract the flag.'
date: 2025-12-06
tags: ['wannagame', 'forensics', 'ransomware', 'browser-based-malware', 'aes-gcm', 'chrome-cache', 'decryption', 'first-blood']
authors: ['t4mpr']
---

<img src="https://github.com/t4mpr/ctf-writeups/blob/main/WannaGame-Championship-2025-Writeups/images/where_is_the_malware_chal.png?raw=true" alt="Challenge Description" width="50%"/>

## Challenge Overview

This forensics challenge involved investigating a ransomware attack on a victim named Alex. The attacker used a fake EVKey installer (`evkau.exe`) that deployed browser-based encryption malware. The goal was to locate the malicious code, recover the encryption key, decrypt the victim's files, and extract the flag.

---

## Step-by-step Guide

### 1. Survey the Victim Profile and Ransom Note

```bash
cd /mnt/c/ctf/_W1/forensics/where_is_the_malware
cat C/Users/alex/Documents/for_meeting/ransom.txt
```

<img src="https://github.com/t4mpr/ctf-writeups/blob/main/WannaGame-Championship-2025-Writeups/images/where_is_the_malware_ransom_note.png?raw=true" alt="Ransom Note" width="70%"/>

This confirmed Alex's documents were encrypted and listed victim ID `63c4bc5d-6e89-43c3-b618-8d79351f6573`.

### 2. Review Suspicious Downloads and Execution Traces

```bash
ls -al C/Users/alex/Downloads
ls -al C/Users/alex/Downloads/EVKey
ls -al C/Windows/prefetch | rg -i EVKAU
```

<img src="https://github.com/t4mpr/ctf-writeups/blob/main/WannaGame-Championship-2025-Writeups/images/where_is_the_malware_ransom_EVKey.png?raw=true" alt="EVKey Traces" width="70%"/>

The user recently ran `evkau.exe` (a fake EVKey installer) which likely staged the browser-based encryptor.

### 3. Locate the Malicious JavaScript Payload

The user's Chrome cache still held the worker that performed encryption. Searching the cache for AES usage revealed it:

```bash
rg -a "AES" -n C/Users/alex/AppData/Local/Google/Chrome/User\ Data/Default/Cache/Cache_Data/f_0004ab
```

<img src="https://github.com/t4mpr/ctf-writeups/blob/main/WannaGame-Championship-2025-Writeups/images/where_is_the_malware_ransom_EVKey.png?raw=true" alt="AES Discovery" width="70%"/>

#### *Or just look through it manually*

Key excerpts from that cache file:

```javascript
const A = "97640d7edecc04adda142fabe9760513faca90cebce7dd32f4ac6f276e60b509";
const B = "94b4c8343e07d37ce38a87403029414e05c397dffcbfb7d1302a69a089cc79ef";
key = hexXor(A, B);               // derives the AES-256 key
const result = await aes.encrypt(data);
const combined = tag + ciphertext + iv; // order written to disk
```

This clarified both the key derivation (XOR of two 32â€‘byte constants) and the ciphertext layout: `[16-byte tag][ciphertext][16-byte nonce]`.

### 4. Derive the AES-256-GCM Key

```bash
python3 - <<'PY'
from binascii import unhexlify
a = unhexlify("97640d7edecc04adda142fabe9760513faca90cebce7dd32f4ac6f276e60b509")
b = unhexlify("94b4c8343e07d37ce38a87403029414e05c397dffcbfb7d1302a69a089cc79ef")
key = bytes(x ^ y for x, y in zip(a, b))
print(key.hex())  # 03d0c54ae0cbd7d1399ea8ebd95f445dff09071140586ae3c4860687e7accce6
PY
```

**Recovered Key:** `03d0c54ae0cbd7d1399ea8ebd95f445dff09071140586ae3c4860687e7accce6`

### 5. Decrypt the Victim's Files

See decryption helper script in `files/where_is_the_malware_decrypt.py`.

It consumes one encrypted file at a time, assumes the `[tag][ciphertext][iv]` layout, and uses the recovered key.

Example usage:

```bash
mkdir -p tmp/recovered
python3 /mnt/c/ctf/_W1/writeup/files/where_is_the_malware_decrypt.py \
    C/Users/alex/Documents/for_meeting/Bulbasaur.jpg \
    tmp/recovered/Bulbasaur.jpg
```

<img src="https://github.com/t4mpr/ctf-writeups/blob/main/WannaGame-Championship-2025-Writeups/images/where_is_the_malware_decrypt.png?raw=true" alt="Decryption Process" width="70%"/>

I repeated for each file inside `Documents/for_meeting/`

### 6. Validate and Extract the Flag

Once we have all the files for the `for_meeting` folder decrypted, we simply look through our decrypted files in `tmp/recovered/`

<img src="https://github.com/t4mpr/ctf-writeups/blob/main/WannaGame-Championship-2025-Writeups/images/where_is_the_malware_for_meeting.png?raw=true" alt="Decrypted Files" width="70%"/>

Looking through our decrypted files, we come across this beautiful image `Bulbasaur.jpg`:

<img src="https://github.com/t4mpr/ctf-writeups/blob/main/WannaGame-Championship-2025-Writeups/images/Bulbasaur.jpg?raw=true" alt="Bulbasaur with Flag" width="70%"/>

---

## Flag

`W1{hAv3_u_3v3r_kNowN_R4n5omWar3_oN_Brow5eR_???!!!_8QZeXvQjgGE}`

---

## Tools Used

- **ripgrep (rg)** - Fast recursive text search
- **Python 3** - Decryption scripting
- **GPT 5.1 Codex CLI** - AI-assisted analysis
- **Chrome Cache Analysis** - Browser artifact forensics

---

## Artifacts

- **[where_is_the_malware_decrypt.py](https://github.com/t4mpr/ctf-writeups/tree/main/WannaGame-Championship-2025-Writeups/files/where_is_the_malware_decrypt.py)** - Python tool to decrypt encrypted files

---

## Key Takeaways

### Attack Vector Analysis

1. **Initial Compromise:**
   - Victim downloaded fake EVKey installer (`evkau.exe`)
   - Installer deployed browser-based ransomware via Chrome extension/worker

2. **Encryption Method:**
   - AES-256-GCM encryption
   - Key derived from XOR of two hardcoded constants
   - Ciphertext format: `[16-byte tag][ciphertext][16-byte IV]`

3. **Persistence:**
   - Malware operated through Chrome's cache
   - JavaScript worker performed encryption in browser context

### Forensic Artifacts

- **Prefetch Files:** Evidence of `evkau.exe` execution
- **Chrome Cache:** Malicious JavaScript worker with encryption code
- **Encrypted Files:** Documents in `for_meeting/` directory
- **Ransom Note:** `ransom.txt` with victim ID

### Detection Opportunities

1. Monitor for suspicious browser extensions or workers
2. Detect unusual Chrome cache activity
3. Track fake installer downloads (EVKey impersonation)
4. Monitor for mass file encryption patterns

---

## First Blood Achievement

<img src="https://github.com/t4mpr/ctf-writeups/blob/main/WannaGame-Championship-2025-Writeups/images/where_is_the_malware_first_blood.png?raw=true" alt="First Blood" width="70%"/>

This writeup achieved **First Blood** on the challenge! ðŸ©¸

---

## Notes

I used GPT 5.1 Codex CLI to help me solve this challenge. In all honesty, I gave the challenge to the LLM and was looking through it manually. I paused and looked through all of the recovered files and realized that the flag was already there. Fully decrypted.

---

## Acknowledgements

Thank you to **[WannaGame Championship 2025](https://discord.gg/XcJ5sbpnR7)** for hosting a fun and challenging event and to my team **[Lil L3ak](https://www.linkedin.com/company/lil-l3ak/posts/?feedView=all)** for supporting me and all of my teammates.

---

## Connect With Me

I'm currently open to new opportunities. If you work in cyber and you're looking to grow your team, I'd love to talk.

**Let's connect:**
- [LinkedIn](https://www.linkedin.com/in/smosillo/)
- [X](http://x.com/t4mpr)
- [GitHub](http://github.com/t4mpr)

---

**Author:** t4mpr

**Date:** December 6, 2025

**Event:** WannaGame Championship 2025
